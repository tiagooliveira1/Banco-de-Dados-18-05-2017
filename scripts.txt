/* Cria tabela médico */
CREATE TABLE MEDICO (
COD_MEDICO INTEGER NOT NULL,
NOME VARCHAR2(200),
CONSTRAINT pk_medico PRIMARY KEY(COD_MEDICO)
);

/* Cria tabela paciente */
CREATE TABLE PACIENTE (
COD_PACIENTE INTEGER NOT NULL,
NOME VARCHAR2(200),
MEDICO INTEGER NULL,
CONSTRAINT pk_paciente PRIMARY KEY(COD_PACIENTE),
CONSTRAINT fk_medico FOREIGN KEY (MEDICO) REFERENCES MEDICO(COD_MEDICO)
);

/* Insere médicos */
INSERT INTO MEDICO (COD_MEDICO, NOME) VALUES (1, 'DR. JOSÉ JACÓ'); 
INSERT INTO MEDICO (COD_MEDICO, NOME) VALUES (2, 'DR. OCUPADO');
INSERT INTO MEDICO (COD_MEDICO, NOME) VALUES (3, 'DR. VAGO');

/* Insere paciente */
INSERT INTO PACIENTE (COD_PACIENTE, NOME, MEDICO) VALUES (1, 'JESUS', 1); 
INSERT INTO PACIENTE (COD_PACIENTE, NOME, MEDICO) VALUES (2, 'CASSIO DOENTE', 1); 
INSERT INTO PACIENTE (COD_PACIENTE, NOME, MEDICO) VALUES (3, 'FEBRIL DA SILVA', 2); 
INSERT INTO PACIENTE (COD_PACIENTE, NOME, MEDICO) VALUES (4, 'MARCIO COQUELUCHE', 2); 
INSERT INTO PACIENTE (COD_PACIENTE, NOME, MEDICO) VALUES (5, 'CÓLERA SANTOS', 2); 

/* pacientes atendidos pelos médicos */
SELECT M.NOME, P.NOME
FROM MEDICO M
INNER JOIN PACIENTE P ON (P.MEDICO = M.COD_MEDICO)

/* Médicos sem pacientes */
SELECT M.NOME, P.NOME
FROM MEDICO M
LEFT JOIN PACIENTE P ON (P.MEDICO = M.COD_MEDICO)
WHERE P.MEDICO IS NULL

